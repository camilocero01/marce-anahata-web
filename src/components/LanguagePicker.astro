---
import { getRelativeLocaleUrl } from 'astro:i18n';

const currentLang = Astro.currentLocale || 'es';
let currentPath = Astro.url.pathname.replace(/^\/(en|es)\//, '');
// Si estamos en cualquier sección del blog, redirigir a la raíz del blog del idioma destino
if (
  Astro.url.pathname.startsWith('/en/blog') ||
  Astro.url.pathname.startsWith('/blog')
) {
  currentPath = 'blog';
}
---
<div class="flex items-center gap-3">
  <a 
    href={getRelativeLocaleUrl('es', currentPath)}
    class:list={[
      "transition-all hover:scale-110 inline-block",
      currentLang === 'es' ? "opacity-100" : "opacity-40 hover:opacity-70"
    ]}
    title="Español"
  >
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" class="w-7 h-5">
      <rect width="30" height="20" fill="#c60b1e"/>
      <rect width="30" height="6.67" y="6.67" fill="#ffc400"/>
    </svg>
  </a>
  <a 
    href={getRelativeLocaleUrl('en', currentPath)}
    class:list={[
      "transition-all hover:scale-110 inline-block",
      currentLang === 'en' ? "opacity-100" : "opacity-40 hover:opacity-70"
    ]}
    title="English"
  >
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" class="w-7 h-5">
      <clipPath id="t"><path d="M15,10 h15 v10 z v10 h-15 z h-15 v-10 z v-10 h15 z"/></clipPath>
      <path d="M0,0 v20 h30 v-20 z" fill="#012169"/>
      <path d="M0,0 L30,20 M30,0 L0,20" stroke="#fff" stroke-width="4"/>
      <path d="M0,0 L30,20 M30,0 L0,20" clip-path="url(#t)" stroke="#C8102E" stroke-width="2.67"/>
      <path d="M15,0 v20 M0,10 h30" stroke="#fff" stroke-width="6.67"/>
      <path d="M15,0 v20 M0,10 h30" stroke="#C8102E" stroke-width="4"/>
    </svg>
  </a>
</div>
