---
import { getCollection } from 'astro:content';
// Use a const assertion so TypeScript recognizes the collection literal
const posts = await getCollection('blog' as const);
---
<html lang="es">
  <head>
    <title>Blog | Marce Anahata</title>
    <meta name="description" content="Artículos de bienestar, yoga, rituales y salud holística." />
    <link rel="canonical" href="https://marceanahata.com/blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Blog | Marce Anahata" />
    <meta property="og:description" content="Artículos de bienestar, yoga, rituales y salud holística." />
    <meta property="og:url" content="https://marceanahata.com/blog" />
    <meta property="og:image" content="/images/social-preview.jpg" />
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "Blog",
      "name": "Blog | Marce Anahata",
      "description": "Artículos de bienestar, yoga, rituales y salud holística.",
      "url": "https://marceanahata.com/blog"
    })} />
  </head>
  <body>
    <main class="max-w-3xl mx-auto px-4 py-16">
      <h1 class="text-4xl font-serif text-[#243c5a] mb-8">Blog</h1>
      <ul class="space-y-8">
        {posts.sort((a, b) => b.data.pubDate.localeCompare(a.data.pubDate)).map(post => (
          <li>
            <a href={`/blog/${post.slug}/`} class="block group">
              <article class="bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow p-6 border border-stone-100">
                {post.data.image && <img src={post.data.image} alt={post.data.title} class="w-full h-48 object-cover rounded-lg mb-4" loading="lazy" />}
                <h2 class="text-2xl font-serif text-[#243c5a] group-hover:text-[#6ed8d9] mb-2">{post.data.title}</h2>
                <p class="text-stone-600 mb-2">{post.data.description}</p>
                <time class="text-xs text-stone-400">{new Date(post.data.pubDate).toLocaleDateString('es-CO', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
                {post.data.tags && <div class="mt-2 flex flex-wrap gap-2">{post.data.tags.map(tag => <span class="bg-[#6ed8d9]/20 text-[#243c5a] px-2 py-0.5 rounded text-xs">#{tag}</span>)}</div>}
              </article>
            </a>
          </li>
        ))}
      </ul>
    </main>
  </body>
</html>
